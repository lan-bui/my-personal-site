{% extends "template.html" %} {% block main %}
<head>
  <link rel="stylesheet" href="static/image_compare.css" />
</head>
<div>
  <h1>Image Comparison</h1>
  <form action="/compare-image" method="POST" enctype="multipart/form-data">
    <div class="content">
      <span>
        <label for="image1">Image 1:</label>
        <input
          type="file"
          name="image1"
          id="image1"
          accept=".jpg, .jpeg, .png"
        />
        <div id="image1Div"></div>
      </span>
      <span>
        <label for="image2">Image 2:</label>
        <input
          type="file"
          name="image2"
          id="image2"
          accept=".jpg, .jpeg, .png"
        />
        <div id="image2Div"></div>
      </span>
    </div>
    <input type="submit" value="Compare" />
  </form>
  {% if result_image_1 %}
  <h1>Image Comparison Result</h1>
  <div class="content">
    <span
      >In Image2 but not in Image1:
      <div>
        <img
          src="/image-data/{{ result_image_1 }}"
          alt="Comparison Result Image"
        />
      </div>
    </span>
    <span
      >In Image1 but not in Image2:
      <div>
        <img
          src="/image-data/{{ result_image_2 }}"
          alt="Comparison Result Image"
        />
      </div>
    </span>
  </div>
  {% endif %}
</div>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script>
  $("input").change(function (e) {
    for (var i = 0; i < e.originalEvent.srcElement.files.length; i++) {
      var file = e.originalEvent.srcElement.files[i];

      var img = document.createElement("img");
      var reader = new FileReader();
      reader.onloadend = function () {
        img.src = reader.result;
      };
      reader.readAsDataURL(file);

      if (e.originalEvent.target.name == "image1") {
        $("#image1Div").prepend(img);
      } else {
        $("#image2Div").prepend(img);
      }
    }
  });
</script>
{% endblock %}
